class Attribute{constructor(t,s){this.table=t,this.name=s,this.attr=s,this.weight=0,this.diffEdges=0,this.randomEdges=0,this.sameEdges=0}}
class Edge{constructor(t,e,i,h){this.leftTable=t,this.att1=e,this.leftAttribute=e,this.rightTable=i,this.att2=h,this.rightAttribute=h}compareTo(t){if(this.leftTable==t.leftTable)if(this.rightTable==t.rightTable){if(this.leftAttribute.weight>t.leftAttribute.weight&&this.rightAttribute.weight<t.rightAttribute.weight)return!0;if(this.leftAttribute.weight<t.leftAttribute.weight&&this.rightAttribute.weight>t.rightAttribute.weight)return!0}else{if(this.rightTable.weight<t.rightTable.weight&&this.leftAttribute.weight>t.leftAttribute.weight)return!0;if(this.rightTable.weight>t.rightTable.weight&&this.leftAttribute.weight<t.leftAttribute.weight)return!0}else if(this.rightTable==t.rightTable)if(this.leftTable==t.leftTable){if(this.leftAttribute.weight>t.leftAttribute.weight&&this.rightAttribute.weight<t.rightAttribute.weight)return!0;if(this.leftAttribute.weight<t.leftAttribute.weight&&this.rightAttribute.weight>t.rightAttribute.weight)return!0}else{if(this.leftTable.weight<t.leftTable.weight&&this.rightAttribute.weight>t.rightAttribute.weight)return!0;if(this.leftTable.weight>t.leftTable.weight&&this.rightAttribute.weight<t.rightAttribute.weight)return!0}else{if(this.leftTable.weight<t.leftTable.weight&&this.rightTable.weight>t.rightTable.weight)return!0;if(this.leftTable.weight>t.leftTable.weight&&this.rightTable.weight<t.rightTable.weight)return!0}return!1}compareSelfEdgeTo(t){if(this.leftTable.depth==this.rightTable.depth&&t.leftTable.depth==t.rightTable.depth){if(this.leftTable==t.leftTable)if(this.rightTable==t.rightTable){if(this.leftAttribute.weight<t.leftAttribute.weight&&this.rightAttribute.weight<t.rightAttribute.weight)return!0;if(this.leftAttribute.weight>t.leftAttribute.weight&&this.rightAttribute.weight>t.rightAttribute.weight)return!0}else{if(this.leftAttribute.weight<t.leftAttribute.weight&&this.rightTable.weight<t.rightTable.weight)return!0;if(this.leftAttribute.weight>t.leftAttribute.weight&&this.rightTable.weight>t.rightTable.weight)return!0}else if(this.leftTable==t.rightTable)if(this.rightTable==t.leftTable){if(this.rightAttribute.weight<t.leftAttribute.weight&&this.leftAttribute.weight<t.rightAttribute.weight)return!0;if(this.rightAttribute.weight>t.leftAttribute.weight&&this.leftAttribute.weight>t.rightAttribute.weight)return!0}else{if(this.leftAttribute.weight<t.rightAttribute.weight&&this.rightTable.weight<t.leftTable.weight)return!0;if(this.leftAttribute.weight>t.rightAttribute.weight&&this.rightTable.weight>t.leftTable.weight)return!0}else if(this.rightTable==t.leftTable)if(this.leftTable==t.rightTable){if(this.rightAttribute.weight<t.leftAttribute.weight&&this.leftAttribute.weight<t.rightAttribute.weight)return!0;if(this.rightAttribute.weight>t.leftAttribute.weight&&this.leftAttribute.weight>t.rightAttribute.weight)return!0}else{if(this.rightAttribute.weight<t.leftAttribute.weight&&this.leftTable.weight<t.rightTable.weight)return!0;if(this.rightAttribute.weight>t.leftAttribute.weight&&this.leftTable.weight>t.rightTable.weight)return!0}else if(this.rightTable==t.rightTable)if(this.leftTable==t.leftTable){if(this.leftAttribute.weight<t.leftAttribute.weight&&this.rightAttribute.weight<t.rightAttribute.weight)return!0;if(this.leftAttribute.weight>t.leftAttribute.weight&&this.rightAttribute.weight>t.rightAttribute.weight)return!0}else{if(this.rightAttribute.weight<t.rightAttribute.weight&&this.leftTable.weight<t.leftTable.weight)return!0;if(this.rightAttribute.weight>t.rightAttribute.weight&&this.leftTable.weight>t.leftTable.weight)return!0}}else if(this.leftTable.depth==this.rightTable.depth)if(this.leftTable==t.leftTable){if(this.leftAttribute.weight<t.leftAttribute.weight&&this.rightTable.weight>t.leftTable.weight)return!0;if(this.leftAttribute.weight>t.leftAttribute.weight&&this.rightTable.weight<t.leftTable.weight)return!0}else if(this.rightTable==t.rightTable){if(this.rightAttribute.weight<t.leftAttribute.weight&&this.leftTable.weight>t.leftTable.weight)return!0;if(this.rightAttribute.weight>t.leftAttribute.weight&&this.leftTable.weight<t.leftTable.weight)return!0}else{if(this.leftTable.weight>t.leftTable.weight&&this.rightTable.weight<t.leftTable.weight)return!0;if(this.leftTable.weight<t.leftTable.weight&&this.rightTable.weight>t.leftTable.weight)return!0}else if(t.leftTable==this.leftTable){if(t.leftAttribute.weight<this.leftAttribute.weight&&t.rightTable.weight>this.leftTable.weight)return!0;if(t.leftAttribute.weight>this.leftAttribute.weight&&t.rightTable.weight<this.leftTable.weight)return!0}else if(t.rightTable==this.leftTable){if(t.rightAttribute.weight<this.leftAttribute.weight&&t.leftTable.weight>this.leftTable.weight)return!0;if(t.rightAttribute.weight>this.leftAttribute.weight&&t.leftTable.weight<this.leftTable.weight)return!0}else{if(t.leftTable.weight<this.leftAttribute.weight&&t.rightTable.weight>this.leftAttribute.weight)return!0;if(t.leftTable.weight>this.leftAttribute.weight&&t.rightTable.weight<this.leftAttribute.weight)return!0}}crosses(t){return this.leftTable.depth==this.rightTable.depth||t.leftTable.depth==t.rightTable.depth?this.compareSelfEdgeTo(t):!!this.compareTo(t)}}
class Graph{constructor(){this.edges=[],this.tables=[],this.tableIndex=[],this.edgeIndex=[],this.maxDepth=0,this.newLayer()}newLayer(){this.tableIndex.push([]),this.edgeIndex.push([])}addTable(t){for(;this.maxDepth<t.depth;)this.maxDepth+=1,this.newLayer();this.tables.push(t),this.tableIndex[t.depth].push(t)}addEdge(t){this.edges.push(t),this.edgeIndex[t.leftTable.depth].push(t)}ensureUniqueEdges(){}getEdgeCrossings(){let t=0;for(let e in this.edgeIndex)t+=this.getEdgeCrossingsAtDepth(e);return t}getEdgeCrossingsAtDepth(t){let e=0,s=this.edgeIndex[t];for(let t in s){let h=s[t];for(let i=parseFloat(t)+1;i<s.length;i++){let t=s[i];h.crosses(t)&&(console.log("Edge "+h.leftAttribute.name+h.rightAttribute.name+" crosses "+t.leftAttribute.name+t.rightAttribute.name),e+=1)}}return e}sortGraph(){for(let t of this.tables)t.main||(t.attributes=t.attributes.sort((t,e)=>t.weight>e.weight?1:-1));this.tables=this.tables.sort((t,e)=>t.weight>e.weight?1:-1)}setExactWeights(){for(let t in this.tableIndex){let e=this.tableIndex[t];e=e.sort((t,e)=>t.weight>e.weight?1:-1);for(let t in e){let s=e[t];s.weight=t;let h=s.attributes;h=h.sort((t,e)=>t.weight>e.weight?1:-1);for(let t in h)h[t].weight=t}}}}
class GraphGenerator{constructor(t=3,e="hello",r=[2,3],a=[1,5]){this.d=t,this.s=3,this.jd=.1,this.js=.05,this.attributeCounter=0,this.seed=e,this.rng=new Math.seedrandom(this.seed),this.tableDist=()=>r[0]+Math.round(this.rng()*(r[1]-r[0])),this.attrDist=()=>a[0]+Math.round(this.rng()*(a[1]-a[0]))}generate(){g=new Graph;for(var t=1;t<this.d;t++){g.newLayer();for(var e=0;e<this.tableDist();e++)g.addTable(this.generateTable(t,e))}return this.generateProjections(g),this.generateJoins(g),g.ensureUniqueEdges(),g}generateTable(t,e){name="T"+t+"_"+e;for(var r=new Table(name,name,!1,t),a=0;a<this.attrDist();a++)r.addAttribute("a"+this.attributeCounter),this.attributeCounter+=1;return r}generateProjections(t){let e=t.tableIndex[1],r=[],a=new Table("select","SELECT",!0,0),s=[],n=[],i=0;for(let t of e){let e=t.attributes,a=e[Math.floor(this.rng()*e.length)];s.push(a),n.push(a);for(let s of e)s!=a&&r.push(new Attribute(t,s));i++}let o=this.s*(r.length+i);for(t.addTable(a);i<o;i++){let t=Math.floor(this.rng()*r.length);r[t];r.splice(t,1)}for(let e of s){let r=new Attribute(a,"a"+this.attributeCounter++);a.attributes.push(r),t.addEdge(new Edge(a,r,e.table,e))}}generateInterLayerJoins(t){for(var e=1;e<this.d;e++){let r=t.tableIndex[e],a=t.tableIndex[e+1],s=[],n=[];for(let t of r){let e=t.attributes;for(let r of e)s.push(new Attribute(t,r))}for(let e of a){if(0==s.length)break;let r=e.attributes,a=r[Math.floor(this.rng()*r.length)],i=Math.floor(this.rng()*s.length),o=s[i];s.splice(i,1),t.addEdge(new Edge(o.table,o.attr,e,a)),o.diffEdges++,a.diffEdges++;for(let t of r)t!=a&&n.push(new Attribute(e,t))}for(let e of s){if(0==n.length)break;if(this.rng()<this.jd){let r=Math.floor(this.rng()*n.length),a=n[r];n.splice(r,1),t.addEdge(new Edge(e.table,e.attr,a.table,a.attr)),e.diffEdges++,a.diffEdges++}}}}generateInLayerJoins(){for(var t=1;t<this.d;t++){let e=g.tableIndex[t];for(let t of e){let r=[],a=[];for(let e of t.attributes)r.push(new Attribute(t,e));for(let r of e)if(t!=r)for(let t of r.attributes)0==t.sameEdges&&a.push(new Attribute(r,t));for(let t of r){if(0==a.length)break;if(this.rng()<this.js){let e=Math.floor(this.rng()*a.length),r=a[e];a.splice(e,1),g.addEdge(new Edge(t.table,t.attr,r.table,r.attr)),t.sameEdges++,r.sameEdges++}}}}}generateRandomJoins(){}generateJoins(t){this.generateInterLayerJoins(t),this.generateInLayerJoins(t),this.generateRandomJoins(t)}}
class Table{constructor(t,h,i,e){this.name=t,this.header=h,this.main=i,this.depth=e,this.attributes=[],this.attrMaps=[],this.weight=0}addAttribute(t){this.attributes.push(new Attribute(this,t))}compareTo(t){return this.depth<t.depth?-1:this.depth>t.depth?1:this.weight>t.weight}}
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkF0dHJpYnV0ZS5qcyIsIkVkZ2UuanMiLCJHcmFwaC5qcyIsIkdyYXBoR2VuZXJhdG9yLmpzIiwiVGFibGUuanMiXSwibmFtZXMiOlsiQXR0cmlidXRlIiwiW29iamVjdCBPYmplY3RdIiwidGFibGUiLCJuYW1lIiwidGhpcyIsImF0dHIiLCJ3ZWlnaHQiLCJkaWZmRWRnZXMiLCJyYW5kb21FZGdlcyIsInNhbWVFZGdlcyIsIkVkZ2UiLCJsZWZ0VGFibGUiLCJhdHQxIiwicmlndGhUYWJsZSIsImF0dDIiLCJsZWZ0QXR0cmlidXRlIiwicmlnaHRUYWJsZSIsInJpZ2h0QXR0cmlidXRlIiwib3RoZXJFZGdlIiwiZGVwdGgiLCJjb21wYXJlU2VsZkVkZ2VUbyIsImNvbXBhcmVUbyIsIkdyYXBoIiwiZWRnZXMiLCJ0YWJsZXMiLCJ0YWJsZUluZGV4IiwiZWRnZUluZGV4IiwibWF4RGVwdGgiLCJuZXdMYXllciIsInB1c2giLCJlZGdlIiwiY291bnQiLCJkIiwiZ2V0RWRnZUNyb3NzaW5nc0F0RGVwdGgiLCJjcm9zc2luZ3MiLCJsYXllckVkZ2VzIiwiaSIsImN1cnJFZGdlIiwiaiIsInBhcnNlRmxvYXQiLCJsZW5ndGgiLCJjcm9zc2VzIiwiY29uc29sZSIsImxvZyIsInQiLCJtYWluIiwiYXR0cmlidXRlcyIsInNvcnQiLCJhIiwiYiIsImxheWVyVGFibGVzIiwiYXR0cnMiLCJrIiwiR3JhcGhHZW5lcmF0b3IiLCJzZWVkIiwidGFibGVEaXN0cmlidXRpb24iLCJhdHRyaWJ1dGVEaXN0cmlidXRpb24iLCJzIiwiamQiLCJqcyIsImF0dHJpYnV0ZUNvdW50ZXIiLCJybmciLCJNYXRoIiwic2VlZHJhbmRvbSIsInRhYmxlRGlzdCIsInJvdW5kIiwiYXR0ckRpc3QiLCJnIiwiYWRkVGFibGUiLCJnZW5lcmF0ZVRhYmxlIiwiZ2VuZXJhdGVQcm9qZWN0aW9ucyIsImdlbmVyYXRlSm9pbnMiLCJlbnN1cmVVbmlxdWVFZGdlcyIsImluZGV4IiwibmV3VGFibGUiLCJUYWJsZSIsImFkZEF0dHJpYnV0ZSIsImxheWVyMSIsImxheWVyMWF0dHJzIiwic2VsZWN0VGFibGUiLCJwcm9qZWN0ZWRBdHRycyIsInByb2plY3RlZCIsInByb2plY3RlZENvdW50Iiwic3RyaWN0IiwiZmxvb3IiLCJjb3VudFByb2plY3Rpb25zIiwiYXR0ckluZGV4Iiwic3BsaWNlIiwibmV3QXR0ciIsImFkZEVkZ2UiLCJsZWZ0TGF5ZXIiLCJyaWdodExheWVyIiwibGVmdExheWVyQXR0cnMiLCJyaWdodExheWVyQXR0cnMiLCJsZWZ0SW5kZXgiLCJsZWZ0IiwicmlnaHRJbmRleCIsInJpZ2h0IiwibGF5ZXIiLCJ0MSIsImF0dHJzMSIsImF0dHJzMiIsInQyIiwiYXR0cjEiLCJhdHRyMmluZGV4IiwiYXR0cjIiLCJnZW5lcmF0ZUludGVyTGF5ZXJKb2lucyIsImdlbmVyYXRlSW5MYXllckpvaW5zIiwiZ2VuZXJhdGVSYW5kb21Kb2lucyIsImhlYWRlciIsImF0dHJNYXBzIiwiYXR0cmlidXRlIiwib3RoZXJUYWJsZSJdLCJtYXBwaW5ncyI6IkFBQUEsTUFBTUEsVUFDRkMsWUFBWUMsRUFBT0MsR0FDZkMsS0FBS0YsTUFBUUEsRUFDYkUsS0FBS0QsS0FBT0EsRUFDWkMsS0FBS0MsS0FBT0YsRUFDWkMsS0FBS0UsT0FBUyxFQUNkRixLQUFLRyxVQUFZLEVBQ2pCSCxLQUFLSSxZQUFjLEVBQ25CSixLQUFLSyxVQUFZO0FDUnpCLE1BQU1DLEtBQ0ZULFlBQVlVLEVBQVdDLEVBQU1DLEVBQVlDLEdBQ3JDVixLQUFLTyxVQUFZQSxFQUNqQlAsS0FBS1EsS0FBT0EsRUFDWlIsS0FBS1csY0FBZ0JILEVBQ3JCUixLQUFLWSxXQUFhSCxFQUNsQlQsS0FBS1UsS0FBT0EsRUFDWlYsS0FBS2EsZUFBaUJILEVBRzFCYixVQUFVaUIsR0FDTixHQUFJZCxLQUFLTyxXQUFhTyxFQUFVUCxVQUU1QixHQUFJUCxLQUFLWSxZQUFjRSxFQUFVRixXQUFXLENBRXhDLEdBQUlaLEtBQUtXLGNBQWNULE9BQVNZLEVBQVVILGNBQWNULFFBQVVGLEtBQUthLGVBQWVYLE9BQVNZLEVBQVVELGVBQWVYLE9BQ3BILE9BQU8sRUFDTixHQUFJRixLQUFLVyxjQUFjVCxPQUFTWSxFQUFVSCxjQUFjVCxRQUFVRixLQUFLYSxlQUFlWCxPQUFTWSxFQUFVRCxlQUFlWCxPQUN6SCxPQUFPLE1BQ1IsQ0FBQSxHQUFJRixLQUFLWSxXQUFXVixPQUFTWSxFQUFVRixXQUFXVixRQUFVRixLQUFLVyxjQUFjVCxPQUFTWSxFQUFVSCxjQUFjVCxPQUVuSCxPQUFPLEVBQ04sR0FBSUYsS0FBS1ksV0FBV1YsT0FBU1ksRUFBVUYsV0FBV1YsUUFBVUYsS0FBS1csY0FBY1QsT0FBU1ksRUFBVUgsY0FBY1QsT0FFakgsT0FBTyxPQUNSLEdBQUlGLEtBQUtZLFlBQWNFLEVBQVVGLFdBRXBDLEdBQUlaLEtBQUtPLFdBQWFPLEVBQVVQLFVBQVUsQ0FFdEMsR0FBSVAsS0FBS1csY0FBY1QsT0FBU1ksRUFBVUgsY0FBY1QsUUFBVUYsS0FBS2EsZUFBZVgsT0FBU1ksRUFBVUQsZUFBZVgsT0FDcEgsT0FBTyxFQUNOLEdBQUlGLEtBQUtXLGNBQWNULE9BQVNZLEVBQVVILGNBQWNULFFBQVVGLEtBQUthLGVBQWVYLE9BQVNZLEVBQVVELGVBQWVYLE9BQ3pILE9BQU8sTUFDUixDQUFBLEdBQUlGLEtBQUtPLFVBQVVMLE9BQVNZLEVBQVVQLFVBQVVMLFFBQVVGLEtBQUthLGVBQWVYLE9BQVNZLEVBQVVELGVBQWVYLE9BRW5ILE9BQU8sRUFDTixHQUFJRixLQUFLTyxVQUFVTCxPQUFTWSxFQUFVUCxVQUFVTCxRQUFVRixLQUFLYSxlQUFlWCxPQUFTWSxFQUFVRCxlQUFlWCxPQUVqSCxPQUFPLE1BQ1IsQ0FFSCxHQUFJRixLQUFLTyxVQUFVTCxPQUFTWSxFQUFVUCxVQUFVTCxRQUFVRixLQUFLWSxXQUFXVixPQUFTWSxFQUFVRixXQUFXVixPQUNwRyxPQUFPLEVBQ04sR0FBSUYsS0FBS08sVUFBVUwsT0FBU1ksRUFBVVAsVUFBVUwsUUFBVUYsS0FBS1ksV0FBV1YsT0FBU1ksRUFBVUYsV0FBV1YsT0FDekcsT0FBTyxFQUlmLE9BQU8sRUFHWEwsa0JBQWtCaUIsR0FDZCxHQUFJZCxLQUFLTyxVQUFVUSxPQUFTZixLQUFLWSxXQUFXRyxPQUFTRCxFQUFVUCxVQUFVUSxPQUFTRCxFQUFVRixXQUFXRyxPQUVuRyxHQUFJZixLQUFLTyxXQUFhTyxFQUFVUCxVQUU1QixHQUFJUCxLQUFLWSxZQUFjRSxFQUFVRixXQUFXLENBRXhDLEdBQUlaLEtBQUtXLGNBQWNULE9BQVNZLEVBQVVILGNBQWNULFFBQVVGLEtBQUthLGVBQWVYLE9BQVNZLEVBQVVELGVBQWVYLE9BQ3BILE9BQU8sRUFDTixHQUFJRixLQUFLVyxjQUFjVCxPQUFTWSxFQUFVSCxjQUFjVCxRQUFVRixLQUFLYSxlQUFlWCxPQUFTWSxFQUFVRCxlQUFlWCxPQUN6SCxPQUFPLE1BQ1IsQ0FDSCxHQUFJRixLQUFLVyxjQUFjVCxPQUFTWSxFQUFVSCxjQUFjVCxRQUFVRixLQUFLWSxXQUFXVixPQUFTWSxFQUFVRixXQUFXVixPQUM1RyxPQUFPLEVBQ04sR0FBSUYsS0FBS1csY0FBY1QsT0FBU1ksRUFBVUgsY0FBY1QsUUFBVUYsS0FBS1ksV0FBV1YsT0FBU1ksRUFBVUYsV0FBV1YsT0FDakgsT0FBTyxPQUVaLEdBQUlGLEtBQUtPLFdBQWFPLEVBQVVGLFdBRW5DLEdBQUlaLEtBQUtZLFlBQWNFLEVBQVVQLFVBQVUsQ0FFdkMsR0FBSVAsS0FBS2EsZUFBZVgsT0FBU1ksRUFBVUgsY0FBY1QsUUFBVUYsS0FBS1csY0FBY1QsT0FBU1ksRUFBVUQsZUFBZVgsT0FDcEgsT0FBTyxFQUNOLEdBQUlGLEtBQUthLGVBQWVYLE9BQVNZLEVBQVVILGNBQWNULFFBQVVGLEtBQUtXLGNBQWNULE9BQVNZLEVBQVVELGVBQWVYLE9BQ3pILE9BQU8sTUFDUixDQUNILEdBQUlGLEtBQUtXLGNBQWNULE9BQVNZLEVBQVVELGVBQWVYLFFBQVVGLEtBQUtZLFdBQVdWLE9BQVNZLEVBQVVQLFVBQVVMLE9BQzVHLE9BQU8sRUFDTixHQUFJRixLQUFLVyxjQUFjVCxPQUFTWSxFQUFVRCxlQUFlWCxRQUFVRixLQUFLWSxXQUFXVixPQUFTWSxFQUFVUCxVQUFVTCxPQUNqSCxPQUFPLE9BRVosR0FBSUYsS0FBS1ksWUFBY0UsRUFBVVAsVUFFcEMsR0FBSVAsS0FBS08sV0FBYU8sRUFBVUYsV0FBVyxDQUN2QyxHQUFJWixLQUFLYSxlQUFlWCxPQUFTWSxFQUFVSCxjQUFjVCxRQUFVRixLQUFLVyxjQUFjVCxPQUFTWSxFQUFVRCxlQUFlWCxPQUNwSCxPQUFPLEVBQ04sR0FBSUYsS0FBS2EsZUFBZVgsT0FBU1ksRUFBVUgsY0FBY1QsUUFBVUYsS0FBS1csY0FBY1QsT0FBU1ksRUFBVUQsZUFBZVgsT0FDekgsT0FBTyxNQUNSLENBQ0gsR0FBSUYsS0FBS2EsZUFBZVgsT0FBU1ksRUFBVUgsY0FBY1QsUUFBVUYsS0FBS08sVUFBVUwsT0FBU1ksRUFBVUYsV0FBV1YsT0FDNUcsT0FBTyxFQUNOLEdBQUlGLEtBQUthLGVBQWVYLE9BQVNZLEVBQVVILGNBQWNULFFBQVVGLEtBQUtPLFVBQVVMLE9BQVNZLEVBQVVGLFdBQVdWLE9BQ2pILE9BQU8sT0FFWixHQUFJRixLQUFLWSxZQUFjRSxFQUFVRixXQUVwQyxHQUFJWixLQUFLTyxXQUFhTyxFQUFVUCxVQUFVLENBRXRDLEdBQUlQLEtBQUtXLGNBQWNULE9BQVNZLEVBQVVILGNBQWNULFFBQVVGLEtBQUthLGVBQWVYLE9BQVNZLEVBQVVELGVBQWVYLE9BQ3BILE9BQU8sRUFDTixHQUFJRixLQUFLVyxjQUFjVCxPQUFTWSxFQUFVSCxjQUFjVCxRQUFVRixLQUFLYSxlQUFlWCxPQUFTWSxFQUFVRCxlQUFlWCxPQUN6SCxPQUFPLE1BQ1IsQ0FDSCxHQUFJRixLQUFLYSxlQUFlWCxPQUFTWSxFQUFVRCxlQUFlWCxRQUFVRixLQUFLTyxVQUFVTCxPQUFTWSxFQUFVUCxVQUFVTCxPQUM1RyxPQUFPLEVBQ04sR0FBSUYsS0FBS2EsZUFBZVgsT0FBU1ksRUFBVUQsZUFBZVgsUUFBVUYsS0FBS08sVUFBVUwsT0FBU1ksRUFBVVAsVUFBVUwsT0FDakgsT0FBTyxRQUtuQixHQUFJRixLQUFLTyxVQUFVUSxPQUFTZixLQUFLWSxXQUFXRyxNQUV4QyxHQUFJZixLQUFLTyxXQUFhTyxFQUFVUCxVQUFVLENBRXRDLEdBQUlQLEtBQUtXLGNBQWNULE9BQVNZLEVBQVVILGNBQWNULFFBQVVGLEtBQUtZLFdBQVdWLE9BQVNZLEVBQVVQLFVBQVVMLE9BQzNHLE9BQU8sRUFDTixHQUFJRixLQUFLVyxjQUFjVCxPQUFTWSxFQUFVSCxjQUFjVCxRQUFVRixLQUFLWSxXQUFXVixPQUFTWSxFQUFVUCxVQUFVTCxPQUNoSCxPQUFPLE9BQ1IsR0FBSUYsS0FBS1ksWUFBY0UsRUFBVUYsV0FBVyxDQUUvQyxHQUFJWixLQUFLYSxlQUFlWCxPQUFTWSxFQUFVSCxjQUFjVCxRQUFVRixLQUFLTyxVQUFVTCxPQUFTWSxFQUFVUCxVQUFVTCxPQUMzRyxPQUFPLEVBQ04sR0FBSUYsS0FBS2EsZUFBZVgsT0FBU1ksRUFBVUgsY0FBY1QsUUFBVUYsS0FBS08sVUFBVUwsT0FBU1ksRUFBVVAsVUFBVUwsT0FDaEgsT0FBTyxNQUNSLENBRUgsR0FBSUYsS0FBS08sVUFBVUwsT0FBU1ksRUFBVVAsVUFBVUwsUUFBVUYsS0FBS1ksV0FBV1YsT0FBU1ksRUFBVVAsVUFBVUwsT0FDbkcsT0FBTyxFQUNOLEdBQUlGLEtBQUtPLFVBQVVMLE9BQVNZLEVBQVVQLFVBQVVMLFFBQVVGLEtBQUtZLFdBQVdWLE9BQVNZLEVBQVVQLFVBQVVMLE9BQ3hHLE9BQU8sT0FJZixHQUFJWSxFQUFVUCxXQUFhUCxLQUFLTyxVQUFVLENBRXRDLEdBQUlPLEVBQVVILGNBQWNULE9BQVNGLEtBQUtXLGNBQWNULFFBQVVZLEVBQVVGLFdBQVdWLE9BQVNGLEtBQUtPLFVBQVVMLE9BQzNHLE9BQU8sRUFDTixHQUFJWSxFQUFVSCxjQUFjVCxPQUFTRixLQUFLVyxjQUFjVCxRQUFVWSxFQUFVRixXQUFXVixPQUFTRixLQUFLTyxVQUFVTCxPQUNoSCxPQUFPLE9BQ1IsR0FBSVksRUFBVUYsWUFBY1osS0FBS08sVUFBVSxDQUU5QyxHQUFJTyxFQUFVRCxlQUFlWCxPQUFTRixLQUFLVyxjQUFjVCxRQUFVWSxFQUFVUCxVQUFVTCxPQUFTRixLQUFLTyxVQUFVTCxPQUMzRyxPQUFPLEVBQ04sR0FBSVksRUFBVUQsZUFBZVgsT0FBU0YsS0FBS1csY0FBY1QsUUFBVVksRUFBVVAsVUFBVUwsT0FBU0YsS0FBS08sVUFBVUwsT0FDaEgsT0FBTyxNQUNSLENBRUgsR0FBSVksRUFBVVAsVUFBVUwsT0FBU0YsS0FBS1csY0FBY1QsUUFBVVksRUFBVUYsV0FBV1YsT0FBU0YsS0FBS1csY0FBY1QsT0FDM0csT0FBTyxFQUNOLEdBQUlZLEVBQVVQLFVBQVVMLE9BQVNGLEtBQUtXLGNBQWNULFFBQVVZLEVBQVVGLFdBQVdWLE9BQVNGLEtBQUtXLGNBQWNULE9BQ2hILE9BQU8sR0FNM0JMLFFBQVFpQixHQUNKLE9BQUlkLEtBQUtPLFVBQVVRLE9BQVNmLEtBQUtZLFdBQVdHLE9BQVNELEVBQVVQLFVBQVVRLE9BQVNELEVBQVVGLFdBQVdHLE1BQzVGZixLQUFLZ0Isa0JBQWtCRixLQUU5QmQsS0FBS2lCLFVBQVVIO0FDbEszQixNQUFNSSxNQUNGckIsY0FDSUcsS0FBS21CLE1BQVEsR0FDYm5CLEtBQUtvQixPQUFTLEdBQ2RwQixLQUFLcUIsV0FBYSxHQUNsQnJCLEtBQUtzQixVQUFZLEdBQ2pCdEIsS0FBS3VCLFNBQVcsRUFDaEJ2QixLQUFLd0IsV0FHVDNCLFdBQ0lHLEtBQUtxQixXQUFXSSxLQUFLLElBQ3JCekIsS0FBS3NCLFVBQVVHLEtBQUssSUFHeEI1QixTQUFTQyxHQUNMLEtBQU1FLEtBQUt1QixTQUFXekIsRUFBTWlCLE9BQ3hCZixLQUFLdUIsVUFBVSxFQUNmdkIsS0FBS3dCLFdBR1R4QixLQUFLb0IsT0FBT0ssS0FBSzNCLEdBQ2pCRSxLQUFLcUIsV0FBV3ZCLEVBQU1pQixPQUFPVSxLQUFLM0IsR0FHdENELFFBQVE2QixHQUNKMUIsS0FBS21CLE1BQU1NLEtBQUtDLEdBQ2hCMUIsS0FBS3NCLFVBQVVJLEVBQUtuQixVQUFVUSxPQUFPVSxLQUFLQyxHQUc5QzdCLHFCQUlBQSxtQkFDSSxJQUFJOEIsRUFBUSxFQUNaLElBQUssSUFBSUMsS0FBSzVCLEtBQUtzQixVQUFXSyxHQUFTM0IsS0FBSzZCLHdCQUF3QkQsR0FDcEUsT0FBT0QsRUFHWDlCLHdCQUF3QitCLEdBQ3BCLElBQUlFLEVBQVksRUFDWkMsRUFBYS9CLEtBQUtzQixVQUFVTSxHQUVoQyxJQUFLLElBQUlJLEtBQUtELEVBQVcsQ0FDckIsSUFBSUUsRUFBV0YsRUFBV0MsR0FDMUIsSUFBSyxJQUFJRSxFQUFJQyxXQUFXSCxHQUFHLEVBQUdFLEVBQUlILEVBQVdLLE9BQVFGLElBQUksQ0FDckQsSUFBSXBCLEVBQVlpQixFQUFXRyxHQUN2QkQsRUFBU0ksUUFBUXZCLEtBQ2pCd0IsUUFBUUMsSUFBSSxRQUFVTixFQUFTdEIsY0FBY1osS0FBT2tDLEVBQVNwQixlQUFlZCxLQUFPLFlBQWNlLEVBQVVILGNBQWNaLEtBQU9lLEVBQVVELGVBQWVkLE1BQ3pKK0IsR0FBVyxJQUt2QixPQUFPQSxFQUdYakMsWUFDSSxJQUFLLElBQUkyQyxLQUFLeEMsS0FBS29CLE9BQ1ZvQixFQUFFQyxPQUNIRCxFQUFFRSxXQUFhRixFQUFFRSxXQUFXQyxLQUFLLENBQUNDLEVBQUdDLElBQU1ELEVBQUUxQyxPQUFTMkMsRUFBRTNDLE9BQVEsR0FBSyxJQUk3RUYsS0FBS29CLE9BQVNwQixLQUFLb0IsT0FBT3VCLEtBQUssQ0FBQ0MsRUFBR0MsSUFBTUQsRUFBRTFDLE9BQVMyQyxFQUFFM0MsT0FBUSxHQUFLLEdBR3ZFTCxrQkFDSSxJQUFLLElBQUltQyxLQUFLaEMsS0FBS3FCLFdBQVcsQ0FDMUIsSUFBSXlCLEVBQWM5QyxLQUFLcUIsV0FBV1csR0FDbENjLEVBQWNBLEVBQVlILEtBQUssQ0FBQ0MsRUFBR0MsSUFBTUQsRUFBRTFDLE9BQVMyQyxFQUFFM0MsT0FBUSxHQUFLLEdBQ25FLElBQUssSUFBSWdDLEtBQUtZLEVBQVksQ0FDdEIsSUFBSWhELEVBQVFnRCxFQUFZWixHQUN4QnBDLEVBQU1JLE9BQVNnQyxFQUVmLElBQUlhLEVBQVFqRCxFQUFNNEMsV0FDbEJLLEVBQVFBLEVBQU1KLEtBQUssQ0FBQ0MsRUFBR0MsSUFBTUQsRUFBRTFDLE9BQVMyQyxFQUFFM0MsT0FBUSxHQUFLLEdBRXZELElBQUssSUFBSThDLEtBQUtELEVBQ1ZBLEVBQU1DLEdBQUc5QyxPQUFTOEM7QUNoRnRDLE1BQU1DLGVBQ0ZwRCxZQUFZa0IsRUFBTSxFQUFHbUMsRUFBSyxRQUFTQyxFQUFvQixDQUFDLEVBQUUsR0FBSUMsRUFBc0IsQ0FBQyxFQUFHLElBQ3BGcEQsS0FBSzRCLEVBQUliLEVBQ1RmLEtBQUtxRCxFQUFJLEVBQ1RyRCxLQUFLc0QsR0FBSyxHQUNWdEQsS0FBS3VELEdBQUssSUFDVnZELEtBQUt3RCxpQkFBbUIsRUFDeEJ4RCxLQUFLa0QsS0FBT0EsRUFHWmxELEtBQUt5RCxJQUFNLElBQUlDLEtBQUtDLFdBQVczRCxLQUFLa0QsTUFDcENsRCxLQUFLNEQsVUFBWSxJQUFNVCxFQUFrQixHQUFLTyxLQUFLRyxNQUFNN0QsS0FBS3lELE9BQVNOLEVBQWtCLEdBQUtBLEVBQWtCLEtBQ2hIbkQsS0FBSzhELFNBQVcsSUFBTVYsRUFBc0IsR0FBS00sS0FBS0csTUFBTTdELEtBQUt5RCxPQUFTTCxFQUFzQixHQUFLQSxFQUFzQixLQUcvSHZELFdBQ0lrRSxFQUFJLElBQUk3QyxNQUVSLElBQUssSUFBSWMsRUFBRSxFQUFHQSxFQUFFaEMsS0FBSzRCLEVBQUdJLElBQUksQ0FDeEIrQixFQUFFdkMsV0FDRixJQUFLLElBQUlVLEVBQUUsRUFBR0EsRUFBRWxDLEtBQUs0RCxZQUFhMUIsSUFDOUI2QixFQUFFQyxTQUFTaEUsS0FBS2lFLGNBQWNqQyxFQUFHRSxJQVN6QyxPQUxBbEMsS0FBS2tFLG9CQUFvQkgsR0FDekIvRCxLQUFLbUUsY0FBY0osR0FFbkJBLEVBQUVLLG9CQUVLTCxFQUdYbEUsY0FBY2tCLEVBQU9zRCxHQUNqQnRFLEtBQU8sSUFBTWdCLEVBQVEsSUFBTXNELEVBRzNCLElBRkEsSUFBSUMsRUFBVyxJQUFJQyxNQUFNeEUsS0FBTUEsTUFBTSxFQUFPZ0IsR0FFbkNpQixFQUFFLEVBQUdBLEVBQUVoQyxLQUFLOEQsV0FBWTlCLElBQzdCc0MsRUFBU0UsYUFBYSxJQUFNeEUsS0FBS3dELGtCQUNqQ3hELEtBQUt3RCxrQkFBb0IsRUFHN0IsT0FBT2MsRUFHWHpFLG9CQUFvQmtFLEdBQ2hCLElBQUlVLEVBQVNWLEVBQUUxQyxXQUFXLEdBQ3RCcUQsRUFBYyxHQUNkQyxFQUFjLElBQUlKLE1BQU0sU0FBVSxVQUFVLEVBQU0sR0FDbERLLEVBQWlCLEdBQ2pCQyxFQUFZLEdBQ1pDLEVBQWlCLEVBRXJCLElBQUssSUFBSXRDLEtBQUtpQyxFQUFPLENBQ2pCLElBQUkxQixFQUFRUCxFQUFFRSxXQUVWcUMsRUFBU2hDLEVBREtXLEtBQUtzQixNQUFNaEYsS0FBS3lELE1BQU1WLEVBQU1YLFNBRTlDd0MsRUFBZW5ELEtBQUtzRCxHQUNwQkYsRUFBVXBELEtBQUtzRCxHQUVmLElBQUssSUFBSTlFLEtBQVE4QyxFQUNUOUMsR0FBUThFLEdBQ1JMLEVBQVlqRCxLQUFLLElBQUk3QixVQUFVNEMsRUFBR3ZDLElBRzFDNkUsSUFHSixJQUFJRyxFQUFtQmpGLEtBQUtxRCxHQUFLcUIsRUFBWXRDLE9BQVMwQyxHQUl0RCxJQUZBZixFQUFFQyxTQUFTVyxHQUVKRyxFQUFlRyxFQUFrQkgsSUFBaUIsQ0FDckQsSUFBSUksRUFBWXhCLEtBQUtzQixNQUFNaEYsS0FBS3lELE1BQU1pQixFQUFZdEMsUUFDdkNzQyxFQUFZUSxHQUN2QlIsRUFBWVMsT0FBT0QsRUFBVyxHQUdsQyxJQUFLLElBQUlqRixLQUFRMkUsRUFBZSxDQUM1QixJQUFJUSxFQUFVLElBQUl4RixVQUFVK0UsRUFBYSxJQUFNM0UsS0FBS3dELG9CQUNwRG1CLEVBQVlqQyxXQUFXakIsS0FBSzJELEdBQzVCckIsRUFBRXNCLFFBQVEsSUFBSS9FLEtBQUtxRSxFQUFhUyxFQUFTbkYsRUFBS0gsTUFBT0csS0FNN0RKLHdCQUF3QmtFLEdBQ3BCLElBQUssSUFBSS9CLEVBQUksRUFBR0EsRUFBSWhDLEtBQUs0QixFQUFHSSxJQUFJLENBQzVCLElBQUlzRCxFQUFZdkIsRUFBRTFDLFdBQVdXLEdBQ3pCdUQsRUFBYXhCLEVBQUUxQyxXQUFXVyxFQUFJLEdBRTlCd0QsRUFBaUIsR0FDakJDLEVBQWtCLEdBRXRCLElBQUssSUFBSTNGLEtBQVN3RixFQUFVLENBQ3hCLElBQUl2QyxFQUFRakQsRUFBTTRDLFdBQ2xCLElBQUssSUFBSXpDLEtBQVE4QyxFQUNieUMsRUFBZS9ELEtBQUssSUFBSTdCLFVBQVVFLEVBQU9HLElBSWpELElBQUssSUFBSUgsS0FBU3lGLEVBQVcsQ0FDekIsR0FBNkIsR0FBekJDLEVBQWVwRCxPQUFhLE1BQ2hDLElBQUlXLEVBQVFqRCxFQUFNNEMsV0FFZHFDLEVBQVNoQyxFQUFNVyxLQUFLc0IsTUFBTWhGLEtBQUt5RCxNQUFNVixFQUFNWCxTQUUzQ3NELEVBQVloQyxLQUFLc0IsTUFBTWhGLEtBQUt5RCxNQUFNK0IsRUFBZXBELFFBQ2pEdUQsRUFBT0gsRUFBZUUsR0FDMUJGLEVBQWVMLE9BQU9PLEVBQVcsR0FFakMzQixFQUFFc0IsUUFBUSxJQUFJL0UsS0FBS3FGLEVBQUs3RixNQUFPNkYsRUFBSzFGLEtBQU1ILEVBQU9pRixJQUVqRFksRUFBS3hGLFlBQ0w0RSxFQUFPNUUsWUFFUCxJQUFLLElBQUlGLEtBQVE4QyxFQUNUOUMsR0FBUThFLEdBQ1JVLEVBQWdCaEUsS0FBSyxJQUFJN0IsVUFBVUUsRUFBT0csSUFJdEQsSUFBSyxJQUFJMEYsS0FBUUgsRUFBZSxDQUM1QixHQUE4QixHQUExQkMsRUFBZ0JyRCxPQUFhLE1BQ2pDLEdBQUlwQyxLQUFLeUQsTUFBUXpELEtBQUtzRCxHQUFHLENBQ3JCLElBQUlzQyxFQUFhbEMsS0FBS3NCLE1BQU1oRixLQUFLeUQsTUFBTWdDLEVBQWdCckQsUUFDbkR5RCxFQUFRSixFQUFnQkcsR0FDNUJILEVBQWdCTixPQUFPUyxFQUFZLEdBRW5DN0IsRUFBRXNCLFFBQVEsSUFBSS9FLEtBQUtxRixFQUFLN0YsTUFBTzZGLEVBQUsxRixLQUFNNEYsRUFBTS9GLE1BQU8rRixFQUFNNUYsT0FFN0QwRixFQUFLeEYsWUFDTDBGLEVBQU0xRixlQU10Qk4sdUJBQ0ksSUFBSyxJQUFJbUMsRUFBRSxFQUFHQSxFQUFFaEMsS0FBSzRCLEVBQUdJLElBQUksQ0FDeEIsSUFBSThELEVBQVEvQixFQUFFMUMsV0FBV1csR0FFekIsSUFBSyxJQUFJK0QsS0FBTUQsRUFBTSxDQUNqQixJQUFJRSxFQUFTLEdBQ1RDLEVBQVMsR0FFYixJQUFLLElBQUloRyxLQUFROEYsRUFBR3JELFdBQ2hCc0QsRUFBT3ZFLEtBQUssSUFBSTdCLFVBQVVtRyxFQUFJOUYsSUFHbEMsSUFBSyxJQUFJaUcsS0FBTUosRUFDWCxHQUFJQyxHQUFNRyxFQUNWLElBQUssSUFBSWpHLEtBQVFpRyxFQUFHeEQsV0FDTSxHQUFsQnpDLEVBQUtJLFdBQ0w0RixFQUFPeEUsS0FBSyxJQUFJN0IsVUFBVXNHLEVBQUlqRyxJQUkxQyxJQUFLLElBQUlrRyxLQUFTSCxFQUFPLENBQ3JCLEdBQXFCLEdBQWpCQyxFQUFPN0QsT0FBYSxNQUN4QixHQUFJcEMsS0FBS3lELE1BQVF6RCxLQUFLdUQsR0FBRyxDQUNyQixJQUFJNkMsRUFBYTFDLEtBQUtzQixNQUFNaEYsS0FBS3lELE1BQU13QyxFQUFPN0QsUUFDMUNpRSxFQUFRSixFQUFPRyxHQUNuQkgsRUFBT2QsT0FBT2lCLEVBQVksR0FFMUJyQyxFQUFFc0IsUUFBUSxJQUFJL0UsS0FBSzZGLEVBQU1yRyxNQUFPcUcsRUFBTWxHLEtBQU1vRyxFQUFNdkcsTUFBT3VHLEVBQU1wRyxPQUUvRGtHLEVBQU05RixZQUNOZ0csRUFBTWhHLGdCQU8xQlIsdUJBSUFBLGNBQWNrRSxHQUNWL0QsS0FBS3NHLHdCQUF3QnZDLEdBQzdCL0QsS0FBS3VHLHFCQUFxQnhDLEdBQzFCL0QsS0FBS3dHLG9CQUFvQnpDO0FDdkxqQyxNQUFNUSxNQUNGMUUsWUFBWUUsRUFBTTBHLEVBQVFoRSxFQUFNMUIsR0FDNUJmLEtBQUtELEtBQU9BLEVBQ1pDLEtBQUt5RyxPQUFTQSxFQUNkekcsS0FBS3lDLEtBQU9BLEVBQ1p6QyxLQUFLZSxNQUFRQSxFQUNiZixLQUFLMEMsV0FBYSxHQUNsQjFDLEtBQUswRyxTQUFXLEdBQ2hCMUcsS0FBS0UsT0FBUyxFQUdsQkwsYUFBYThHLEdBQ1QzRyxLQUFLMEMsV0FBV2pCLEtBQUssSUFBSTdCLFVBQVVJLEtBQU0yRyxJQUc3QzlHLFVBQVUrRyxHQUNOLE9BQUk1RyxLQUFLZSxNQUFRNkYsRUFBVzdGLE9BQWUsRUFDbENmLEtBQUtlLE1BQVE2RixFQUFXN0YsTUFBYyxFQUNuQ2YsS0FBS0UsT0FBUzBHLEVBQVcxRyIsImZpbGUiOiJkaXN0LmpzIiwic291cmNlc0NvbnRlbnQiOlsiY2xhc3MgQXR0cmlidXRlIHtcclxuICAgIGNvbnN0cnVjdG9yKHRhYmxlLCBuYW1lKXtcclxuICAgICAgICB0aGlzLnRhYmxlID0gdGFibGU7XHJcbiAgICAgICAgdGhpcy5uYW1lID0gbmFtZTtcclxuICAgICAgICB0aGlzLmF0dHIgPSBuYW1lO1xyXG4gICAgICAgIHRoaXMud2VpZ2h0ID0gMDtcclxuICAgICAgICB0aGlzLmRpZmZFZGdlcyA9IDA7XHJcbiAgICAgICAgdGhpcy5yYW5kb21FZGdlcyA9IDA7XHJcbiAgICAgICAgdGhpcy5zYW1lRWRnZXMgPSAwO1xyXG4gICAgfVxyXG59IiwiY2xhc3MgRWRnZSB7XHJcbiAgICBjb25zdHJ1Y3RvcihsZWZ0VGFibGUsIGF0dDEsIHJpZ3RoVGFibGUsIGF0dDIpe1xyXG4gICAgICAgIHRoaXMubGVmdFRhYmxlID0gbGVmdFRhYmxlO1xyXG4gICAgICAgIHRoaXMuYXR0MSA9IGF0dDE7XHJcbiAgICAgICAgdGhpcy5sZWZ0QXR0cmlidXRlID0gYXR0MTtcclxuICAgICAgICB0aGlzLnJpZ2h0VGFibGUgPSByaWd0aFRhYmxlO1xyXG4gICAgICAgIHRoaXMuYXR0MiA9IGF0dDI7XHJcbiAgICAgICAgdGhpcy5yaWdodEF0dHJpYnV0ZSA9IGF0dDI7XHJcbiAgICB9XHJcblxyXG4gICAgY29tcGFyZVRvKG90aGVyRWRnZSl7XHJcbiAgICAgICAgaWYgKHRoaXMubGVmdFRhYmxlID09IG90aGVyRWRnZS5sZWZ0VGFibGUpe1xyXG4gICAgICAgICAgICAvLyBlZGdlcyBoYXZlIHRoZSBzYW1lIGxlZnQgdGFibGVcclxuICAgICAgICAgICAgaWYgKHRoaXMucmlnaHRUYWJsZSA9PSBvdGhlckVkZ2UucmlnaHRUYWJsZSl7XHJcbiAgICAgICAgICAgICAgICAvLyBhbmQgdGhlIHNhbWUgcmlnaHQgdGFibGVcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmxlZnRBdHRyaWJ1dGUud2VpZ2h0ID4gb3RoZXJFZGdlLmxlZnRBdHRyaWJ1dGUud2VpZ2h0ICYmIHRoaXMucmlnaHRBdHRyaWJ1dGUud2VpZ2h0IDwgb3RoZXJFZGdlLnJpZ2h0QXR0cmlidXRlLndlaWdodClcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMubGVmdEF0dHJpYnV0ZS53ZWlnaHQgPCBvdGhlckVkZ2UubGVmdEF0dHJpYnV0ZS53ZWlnaHQgJiYgdGhpcy5yaWdodEF0dHJpYnV0ZS53ZWlnaHQgPiBvdGhlckVkZ2UucmlnaHRBdHRyaWJ1dGUud2VpZ2h0KVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMucmlnaHRUYWJsZS53ZWlnaHQgPCBvdGhlckVkZ2UucmlnaHRUYWJsZS53ZWlnaHQgJiYgdGhpcy5sZWZ0QXR0cmlidXRlLndlaWdodCA+IG90aGVyRWRnZS5sZWZ0QXR0cmlidXRlLndlaWdodClcclxuICAgICAgICAgICAgICAgIC8vIHJpZ2h0IHRhYmxlIGlzIHVuZGVyIGJ1dCBsZWZ0IGF0dHJpYnV0ZSBpcyBvdmVyXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgZWxzZSBpZiAodGhpcy5yaWdodFRhYmxlLndlaWdodCA+IG90aGVyRWRnZS5yaWdodFRhYmxlLndlaWdodCAmJiB0aGlzLmxlZnRBdHRyaWJ1dGUud2VpZ2h0IDwgb3RoZXJFZGdlLmxlZnRBdHRyaWJ1dGUud2VpZ2h0KVxyXG4gICAgICAgICAgICAgICAgLy8gcmlnaHQgdGFibGUgaXMgb3ZlciBidXQgbGVmdCBhdHRyaWJ1dGUgaXMgdW5kZXJcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5yaWdodFRhYmxlID09IG90aGVyRWRnZS5yaWdodFRhYmxlKXtcclxuICAgICAgICAgICAgLy8gZWRnZXMgaGF2ZSB0aGUgc2FtZSByaWdodCB0YWJsZVxyXG4gICAgICAgICAgICBpZiAodGhpcy5sZWZ0VGFibGUgPT0gb3RoZXJFZGdlLmxlZnRUYWJsZSl7XHJcbiAgICAgICAgICAgICAgICAvLyBhbmQgdGhlIHNhbWUgbGVmdCB0YWJsZVxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMubGVmdEF0dHJpYnV0ZS53ZWlnaHQgPiBvdGhlckVkZ2UubGVmdEF0dHJpYnV0ZS53ZWlnaHQgJiYgdGhpcy5yaWdodEF0dHJpYnV0ZS53ZWlnaHQgPCBvdGhlckVkZ2UucmlnaHRBdHRyaWJ1dGUud2VpZ2h0KVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICAgICAgZWxzZSBpZiAodGhpcy5sZWZ0QXR0cmlidXRlLndlaWdodCA8IG90aGVyRWRnZS5sZWZ0QXR0cmlidXRlLndlaWdodCAmJiB0aGlzLnJpZ2h0QXR0cmlidXRlLndlaWdodCA+IG90aGVyRWRnZS5yaWdodEF0dHJpYnV0ZS53ZWlnaHQpXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5sZWZ0VGFibGUud2VpZ2h0IDwgb3RoZXJFZGdlLmxlZnRUYWJsZS53ZWlnaHQgJiYgdGhpcy5yaWdodEF0dHJpYnV0ZS53ZWlnaHQgPiBvdGhlckVkZ2UucmlnaHRBdHRyaWJ1dGUud2VpZ2h0KVxyXG4gICAgICAgICAgICAgICAgLy8gbGVmdCB0YWJsZSBpcyB1bmRlciBidXQgcmlnaHQgYXR0cmlidXRlIGlzIG92ZXJcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICBlbHNlIGlmICh0aGlzLmxlZnRUYWJsZS53ZWlnaHQgPiBvdGhlckVkZ2UubGVmdFRhYmxlLndlaWdodCAmJiB0aGlzLnJpZ2h0QXR0cmlidXRlLndlaWdodCA8IG90aGVyRWRnZS5yaWdodEF0dHJpYnV0ZS53ZWlnaHQpXHJcbiAgICAgICAgICAgICAgICAvLyBsZWZ0IHRhYmxlIGlzIG92ZXIgYnV0IHJpZ2h0IGF0dHJpYnV0ZSBpcyB1bmRlclxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8gZWRnZXMgaGF2ZSBkaWZmZXJlbnQgdGFibGVzIGJvdGggb24gdGhlIGxlZnQgYW5kIG9uIHRoZSByaWdodFxyXG4gICAgICAgICAgICBpZiAodGhpcy5sZWZ0VGFibGUud2VpZ2h0IDwgb3RoZXJFZGdlLmxlZnRUYWJsZS53ZWlnaHQgJiYgdGhpcy5yaWdodFRhYmxlLndlaWdodCA+IG90aGVyRWRnZS5yaWdodFRhYmxlLndlaWdodClcclxuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXHJcbiAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMubGVmdFRhYmxlLndlaWdodCA+IG90aGVyRWRnZS5sZWZ0VGFibGUud2VpZ2h0ICYmIHRoaXMucmlnaHRUYWJsZS53ZWlnaHQgPCBvdGhlckVkZ2UucmlnaHRUYWJsZS53ZWlnaHQpe1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWVcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbXBhcmVTZWxmRWRnZVRvKG90aGVyRWRnZSl7XHJcbiAgICAgICAgaWYgKHRoaXMubGVmdFRhYmxlLmRlcHRoID09IHRoaXMucmlnaHRUYWJsZS5kZXB0aCAmJiBvdGhlckVkZ2UubGVmdFRhYmxlLmRlcHRoID09IG90aGVyRWRnZS5yaWdodFRhYmxlLmRlcHRoKXtcclxuICAgICAgICAgICAgLy8gdGhleSBhcmUgYm90aCBzZWxmIGVkZ2VzXHJcbiAgICAgICAgICAgIGlmICh0aGlzLmxlZnRUYWJsZSA9PSBvdGhlckVkZ2UubGVmdFRhYmxlKXtcclxuICAgICAgICAgICAgICAgIC8vIHRoZXkgaGF2ZSB0aGUgc2FtZSBsZWZ0IHRhYmxlXHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5yaWdodFRhYmxlID09IG90aGVyRWRnZS5yaWdodFRhYmxlKXtcclxuICAgICAgICAgICAgICAgICAgICAvLyBhbmQgdGhlIHNhbWUgcmlnaHQgdGFibGVcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5sZWZ0QXR0cmlidXRlLndlaWdodCA8IG90aGVyRWRnZS5sZWZ0QXR0cmlidXRlLndlaWdodCAmJiB0aGlzLnJpZ2h0QXR0cmlidXRlLndlaWdodCA8IG90aGVyRWRnZS5yaWdodEF0dHJpYnV0ZS53ZWlnaHQpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAodGhpcy5sZWZ0QXR0cmlidXRlLndlaWdodCA+IG90aGVyRWRnZS5sZWZ0QXR0cmlidXRlLndlaWdodCAmJiB0aGlzLnJpZ2h0QXR0cmlidXRlLndlaWdodCA+IG90aGVyRWRnZS5yaWdodEF0dHJpYnV0ZS53ZWlnaHQpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmxlZnRBdHRyaWJ1dGUud2VpZ2h0IDwgb3RoZXJFZGdlLmxlZnRBdHRyaWJ1dGUud2VpZ2h0ICYmIHRoaXMucmlnaHRUYWJsZS53ZWlnaHQgPCBvdGhlckVkZ2UucmlnaHRUYWJsZS53ZWlnaHQpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAodGhpcy5sZWZ0QXR0cmlidXRlLndlaWdodCA+IG90aGVyRWRnZS5sZWZ0QXR0cmlidXRlLndlaWdodCAmJiB0aGlzLnJpZ2h0VGFibGUud2VpZ2h0ID4gb3RoZXJFZGdlLnJpZ2h0VGFibGUud2VpZ2h0KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMubGVmdFRhYmxlID09IG90aGVyRWRnZS5yaWdodFRhYmxlKXtcclxuICAgICAgICAgICAgICAgIC8vIHRoZSBsZWZ0IHRhYmxlIG9mIHRoZSBmaXJzdCBpcyB0aGUgcmlnaHQgdGFibGUgb2YgdGhlIG90aGVyXHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5yaWdodFRhYmxlID09IG90aGVyRWRnZS5sZWZ0VGFibGUpe1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIHRoZSBsZWZ0IHRhYmxlIGlzIHRoZSBzYW1lIGFzIHRoZSByaWdodCB0YWJsZVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnJpZ2h0QXR0cmlidXRlLndlaWdodCA8IG90aGVyRWRnZS5sZWZ0QXR0cmlidXRlLndlaWdodCAmJiB0aGlzLmxlZnRBdHRyaWJ1dGUud2VpZ2h0IDwgb3RoZXJFZGdlLnJpZ2h0QXR0cmlidXRlLndlaWdodClcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAodGhpcy5yaWdodEF0dHJpYnV0ZS53ZWlnaHQgPiBvdGhlckVkZ2UubGVmdEF0dHJpYnV0ZS53ZWlnaHQgJiYgdGhpcy5sZWZ0QXR0cmlidXRlLndlaWdodCA+IG90aGVyRWRnZS5yaWdodEF0dHJpYnV0ZS53ZWlnaHQpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5sZWZ0QXR0cmlidXRlLndlaWdodCA8IG90aGVyRWRnZS5yaWdodEF0dHJpYnV0ZS53ZWlnaHQgJiYgdGhpcy5yaWdodFRhYmxlLndlaWdodCA8IG90aGVyRWRnZS5sZWZ0VGFibGUud2VpZ2h0KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICh0aGlzLmxlZnRBdHRyaWJ1dGUud2VpZ2h0ID4gb3RoZXJFZGdlLnJpZ2h0QXR0cmlidXRlLndlaWdodCAmJiB0aGlzLnJpZ2h0VGFibGUud2VpZ2h0ID4gb3RoZXJFZGdlLmxlZnRUYWJsZS53ZWlnaHQpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMucmlnaHRUYWJsZSA9PSBvdGhlckVkZ2UubGVmdFRhYmxlKXtcclxuICAgICAgICAgICAgICAgIC8vIHRoZSByaWdodCB0YWJsZSBvZiB0aGUgZmlyc3QgaXMgdGhlIGxlZnQgdGFibGUgb2YgdGhlIHNlY29uZFxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMubGVmdFRhYmxlID09IG90aGVyRWRnZS5yaWdodFRhYmxlKXtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5yaWdodEF0dHJpYnV0ZS53ZWlnaHQgPCBvdGhlckVkZ2UubGVmdEF0dHJpYnV0ZS53ZWlnaHQgJiYgdGhpcy5sZWZ0QXR0cmlidXRlLndlaWdodCA8IG90aGVyRWRnZS5yaWdodEF0dHJpYnV0ZS53ZWlnaHQpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMucmlnaHRBdHRyaWJ1dGUud2VpZ2h0ID4gb3RoZXJFZGdlLmxlZnRBdHRyaWJ1dGUud2VpZ2h0ICYmIHRoaXMubGVmdEF0dHJpYnV0ZS53ZWlnaHQgPiBvdGhlckVkZ2UucmlnaHRBdHRyaWJ1dGUud2VpZ2h0KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMucmlnaHRBdHRyaWJ1dGUud2VpZ2h0IDwgb3RoZXJFZGdlLmxlZnRBdHRyaWJ1dGUud2VpZ2h0ICYmIHRoaXMubGVmdFRhYmxlLndlaWdodCA8IG90aGVyRWRnZS5yaWdodFRhYmxlLndlaWdodClcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAodGhpcy5yaWdodEF0dHJpYnV0ZS53ZWlnaHQgPiBvdGhlckVkZ2UubGVmdEF0dHJpYnV0ZS53ZWlnaHQgJiYgdGhpcy5sZWZ0VGFibGUud2VpZ2h0ID4gb3RoZXJFZGdlLnJpZ2h0VGFibGUud2VpZ2h0KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLnJpZ2h0VGFibGUgPT0gb3RoZXJFZGdlLnJpZ2h0VGFibGUpe1xyXG4gICAgICAgICAgICAgICAgLy8gdGhleSBoYXZlIHRoZSBzYW1lIHJpZ2h0IHRhYmxlXHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5sZWZ0VGFibGUgPT0gb3RoZXJFZGdlLmxlZnRUYWJsZSl7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gYW5kIHRoZSBzYW1lIHJpZ2h0IHRhYmxlXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMubGVmdEF0dHJpYnV0ZS53ZWlnaHQgPCBvdGhlckVkZ2UubGVmdEF0dHJpYnV0ZS53ZWlnaHQgJiYgdGhpcy5yaWdodEF0dHJpYnV0ZS53ZWlnaHQgPCBvdGhlckVkZ2UucmlnaHRBdHRyaWJ1dGUud2VpZ2h0KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMubGVmdEF0dHJpYnV0ZS53ZWlnaHQgPiBvdGhlckVkZ2UubGVmdEF0dHJpYnV0ZS53ZWlnaHQgJiYgdGhpcy5yaWdodEF0dHJpYnV0ZS53ZWlnaHQgPiBvdGhlckVkZ2UucmlnaHRBdHRyaWJ1dGUud2VpZ2h0KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5yaWdodEF0dHJpYnV0ZS53ZWlnaHQgPCBvdGhlckVkZ2UucmlnaHRBdHRyaWJ1dGUud2VpZ2h0ICYmIHRoaXMubGVmdFRhYmxlLndlaWdodCA8IG90aGVyRWRnZS5sZWZ0VGFibGUud2VpZ2h0KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMucmlnaHRBdHRyaWJ1dGUud2VpZ2h0ID4gb3RoZXJFZGdlLnJpZ2h0QXR0cmlidXRlLndlaWdodCAmJiB0aGlzLmxlZnRUYWJsZS53ZWlnaHQgPiBvdGhlckVkZ2UubGVmdFRhYmxlLndlaWdodClcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWVcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIG9uZSBpcyBhIHNlbGYgZWRnZSBidXQgdGhlIG90aGVyIGlzIG5vdFxyXG4gICAgICAgICAgICBpZiAodGhpcy5sZWZ0VGFibGUuZGVwdGggPT0gdGhpcy5yaWdodFRhYmxlLmRlcHRoKXtcclxuICAgICAgICAgICAgICAgIC8vIHRoZSBmaXJzdCBpcyBhIHNlbGYgZWRnZVxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMubGVmdFRhYmxlID09IG90aGVyRWRnZS5sZWZ0VGFibGUpe1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIHRoZSBmaXJzdCdzIGxlZnQgdGFibGUgaXMgdGhlIHNhbWUgYXMgdGhlIG90aGVyXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMubGVmdEF0dHJpYnV0ZS53ZWlnaHQgPCBvdGhlckVkZ2UubGVmdEF0dHJpYnV0ZS53ZWlnaHQgJiYgdGhpcy5yaWdodFRhYmxlLndlaWdodCA+IG90aGVyRWRnZS5sZWZ0VGFibGUud2VpZ2h0KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMubGVmdEF0dHJpYnV0ZS53ZWlnaHQgPiBvdGhlckVkZ2UubGVmdEF0dHJpYnV0ZS53ZWlnaHQgJiYgdGhpcy5yaWdodFRhYmxlLndlaWdodCA8IG90aGVyRWRnZS5sZWZ0VGFibGUud2VpZ2h0KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLnJpZ2h0VGFibGUgPT0gb3RoZXJFZGdlLnJpZ2h0VGFibGUpe1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIHRoZSBmaXJzdCdzIHJpZ2h0IHRhYmxlIGlzIHRoZSBzYW1lIGFzIHRoZSBvdGhlclxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnJpZ2h0QXR0cmlidXRlLndlaWdodCA8IG90aGVyRWRnZS5sZWZ0QXR0cmlidXRlLndlaWdodCAmJiB0aGlzLmxlZnRUYWJsZS53ZWlnaHQgPiBvdGhlckVkZ2UubGVmdFRhYmxlLndlaWdodClcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWVcclxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICh0aGlzLnJpZ2h0QXR0cmlidXRlLndlaWdodCA+IG90aGVyRWRnZS5sZWZ0QXR0cmlidXRlLndlaWdodCAmJiB0aGlzLmxlZnRUYWJsZS53ZWlnaHQgPCBvdGhlckVkZ2UubGVmdFRhYmxlLndlaWdodClcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWVcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gdGhleSBkb24ndCBzaGFyZSBhbnkgdGFibGVcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5sZWZ0VGFibGUud2VpZ2h0ID4gb3RoZXJFZGdlLmxlZnRUYWJsZS53ZWlnaHQgJiYgdGhpcy5yaWdodFRhYmxlLndlaWdodCA8IG90aGVyRWRnZS5sZWZ0VGFibGUud2VpZ2h0KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICh0aGlzLmxlZnRUYWJsZS53ZWlnaHQgPCBvdGhlckVkZ2UubGVmdFRhYmxlLndlaWdodCAmJiB0aGlzLnJpZ2h0VGFibGUud2VpZ2h0ID4gb3RoZXJFZGdlLmxlZnRUYWJsZS53ZWlnaHQpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8gdGhlIHNlY29uZCBpcyBhIHNlbGYgZWRnZVxyXG4gICAgICAgICAgICAgICAgaWYgKG90aGVyRWRnZS5sZWZ0VGFibGUgPT0gdGhpcy5sZWZ0VGFibGUpe1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIHRoZSBvdGhlcidzIGxlZnQgdGFibGUgaXMgdGhlIHNhbWUgYXMgdGhlIGZpcnN0J3NcclxuICAgICAgICAgICAgICAgICAgICBpZiAob3RoZXJFZGdlLmxlZnRBdHRyaWJ1dGUud2VpZ2h0IDwgdGhpcy5sZWZ0QXR0cmlidXRlLndlaWdodCAmJiBvdGhlckVkZ2UucmlnaHRUYWJsZS53ZWlnaHQgPiB0aGlzLmxlZnRUYWJsZS53ZWlnaHQpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAob3RoZXJFZGdlLmxlZnRBdHRyaWJ1dGUud2VpZ2h0ID4gdGhpcy5sZWZ0QXR0cmlidXRlLndlaWdodCAmJiBvdGhlckVkZ2UucmlnaHRUYWJsZS53ZWlnaHQgPCB0aGlzLmxlZnRUYWJsZS53ZWlnaHQpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlXHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG90aGVyRWRnZS5yaWdodFRhYmxlID09IHRoaXMubGVmdFRhYmxlKXtcclxuICAgICAgICAgICAgICAgICAgICAvLyB0aGUgb3RoZXIncyByaWdodCB0YWJsZSBpcyB0aGUgc2FtZSBhcyB0aGUgZmlyc3QncyByaWdodFxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvdGhlckVkZ2UucmlnaHRBdHRyaWJ1dGUud2VpZ2h0IDwgdGhpcy5sZWZ0QXR0cmlidXRlLndlaWdodCAmJiBvdGhlckVkZ2UubGVmdFRhYmxlLndlaWdodCA+IHRoaXMubGVmdFRhYmxlLndlaWdodClcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWVcclxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChvdGhlckVkZ2UucmlnaHRBdHRyaWJ1dGUud2VpZ2h0ID4gdGhpcy5sZWZ0QXR0cmlidXRlLndlaWdodCAmJiBvdGhlckVkZ2UubGVmdFRhYmxlLndlaWdodCA8IHRoaXMubGVmdFRhYmxlLndlaWdodClcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWVcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gdGhleSBkb24ndCBzaGFyZSBhbnkgdGFibGVcclxuICAgICAgICAgICAgICAgICAgICBpZiAob3RoZXJFZGdlLmxlZnRUYWJsZS53ZWlnaHQgPCB0aGlzLmxlZnRBdHRyaWJ1dGUud2VpZ2h0ICYmIG90aGVyRWRnZS5yaWdodFRhYmxlLndlaWdodCA+IHRoaXMubGVmdEF0dHJpYnV0ZS53ZWlnaHQpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKG90aGVyRWRnZS5sZWZ0VGFibGUud2VpZ2h0ID4gdGhpcy5sZWZ0QXR0cmlidXRlLndlaWdodCAmJiBvdGhlckVkZ2UucmlnaHRUYWJsZS53ZWlnaHQgPCB0aGlzLmxlZnRBdHRyaWJ1dGUud2VpZ2h0KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBjcm9zc2VzKG90aGVyRWRnZSl7XHJcbiAgICAgICAgaWYgKHRoaXMubGVmdFRhYmxlLmRlcHRoID09IHRoaXMucmlnaHRUYWJsZS5kZXB0aCB8fCBvdGhlckVkZ2UubGVmdFRhYmxlLmRlcHRoID09IG90aGVyRWRnZS5yaWdodFRhYmxlLmRlcHRoKSBcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29tcGFyZVNlbGZFZGdlVG8ob3RoZXJFZGdlKVxyXG5cclxuICAgICAgICBpZiAodGhpcy5jb21wYXJlVG8ob3RoZXJFZGdlKSl7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxufSIsImNsYXNzIEdyYXBoIHtcclxuICAgIGNvbnN0cnVjdG9yKCl7XHJcbiAgICAgICAgdGhpcy5lZGdlcyA9IFtdOyBcclxuICAgICAgICB0aGlzLnRhYmxlcyA9IFtdOyBcclxuICAgICAgICB0aGlzLnRhYmxlSW5kZXggPSBbXTsgXHJcbiAgICAgICAgdGhpcy5lZGdlSW5kZXggPSBbXTtcclxuICAgICAgICB0aGlzLm1heERlcHRoID0gMDtcclxuICAgICAgICB0aGlzLm5ld0xheWVyKCk7XHJcbiAgICB9XHJcblxyXG4gICAgbmV3TGF5ZXIoKXtcclxuICAgICAgICB0aGlzLnRhYmxlSW5kZXgucHVzaChbXSlcclxuICAgICAgICB0aGlzLmVkZ2VJbmRleC5wdXNoKFtdKVxyXG4gICAgfVxyXG5cclxuICAgIGFkZFRhYmxlKHRhYmxlKXtcclxuICAgICAgICB3aGlsZSh0aGlzLm1heERlcHRoIDwgdGFibGUuZGVwdGgpe1xyXG4gICAgICAgICAgICB0aGlzLm1heERlcHRoKz0xO1xyXG4gICAgICAgICAgICB0aGlzLm5ld0xheWVyKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLnRhYmxlcy5wdXNoKHRhYmxlKVxyXG4gICAgICAgIHRoaXMudGFibGVJbmRleFt0YWJsZS5kZXB0aF0ucHVzaCh0YWJsZSlcclxuICAgIH1cclxuXHJcbiAgICBhZGRFZGdlKGVkZ2Upe1xyXG4gICAgICAgIHRoaXMuZWRnZXMucHVzaChlZGdlKVxyXG4gICAgICAgIHRoaXMuZWRnZUluZGV4W2VkZ2UubGVmdFRhYmxlLmRlcHRoXS5wdXNoKGVkZ2UpXHJcbiAgICB9XHJcblxyXG4gICAgZW5zdXJlVW5pcXVlRWRnZXMoKXtcclxuICAgICAgICAvLyBmaW5pc2hcclxuICAgIH1cclxuXHJcbiAgICBnZXRFZGdlQ3Jvc3NpbmdzKCl7XHJcbiAgICAgICAgbGV0IGNvdW50ID0gMDtcclxuICAgICAgICBmb3IgKGxldCBkIGluIHRoaXMuZWRnZUluZGV4KSBjb3VudCArPSB0aGlzLmdldEVkZ2VDcm9zc2luZ3NBdERlcHRoKGQpO1xyXG4gICAgICAgIHJldHVybiBjb3VudDtcclxuICAgIH1cclxuXHJcbiAgICBnZXRFZGdlQ3Jvc3NpbmdzQXREZXB0aChkKXtcclxuICAgICAgICBsZXQgY3Jvc3NpbmdzID0gMDtcclxuICAgICAgICBsZXQgbGF5ZXJFZGdlcyA9IHRoaXMuZWRnZUluZGV4W2RdO1xyXG5cclxuICAgICAgICBmb3IgKGxldCBpIGluIGxheWVyRWRnZXMpe1xyXG4gICAgICAgICAgICBsZXQgY3VyckVkZ2UgPSBsYXllckVkZ2VzW2ldO1xyXG4gICAgICAgICAgICBmb3IgKGxldCBqID0gcGFyc2VGbG9hdChpKSsxOyBqIDwgbGF5ZXJFZGdlcy5sZW5ndGg7IGorKyl7XHJcbiAgICAgICAgICAgICAgICBsZXQgb3RoZXJFZGdlID0gbGF5ZXJFZGdlc1tqXTtcclxuICAgICAgICAgICAgICAgIGlmIChjdXJyRWRnZS5jcm9zc2VzKG90aGVyRWRnZSkpe1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRWRnZSBcIiArIGN1cnJFZGdlLmxlZnRBdHRyaWJ1dGUubmFtZSArIGN1cnJFZGdlLnJpZ2h0QXR0cmlidXRlLm5hbWUgKyBcIiBjcm9zc2VzIFwiICsgb3RoZXJFZGdlLmxlZnRBdHRyaWJ1dGUubmFtZSArIG90aGVyRWRnZS5yaWdodEF0dHJpYnV0ZS5uYW1lKVxyXG4gICAgICAgICAgICAgICAgICAgIGNyb3NzaW5ncys9MTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4gY3Jvc3NpbmdzXHJcbiAgICB9XHJcblxyXG4gICAgc29ydEdyYXBoKCl7XHJcbiAgICAgICAgZm9yIChsZXQgdCBvZiB0aGlzLnRhYmxlcyl7XHJcbiAgICAgICAgICAgIGlmICghdC5tYWluKSB7XHJcbiAgICAgICAgICAgICAgICB0LmF0dHJpYnV0ZXMgPSB0LmF0dHJpYnV0ZXMuc29ydCgoYSwgYikgPT4gYS53ZWlnaHQgPiBiLndlaWdodD8gMSA6IC0xKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLnRhYmxlcyA9IHRoaXMudGFibGVzLnNvcnQoKGEsIGIpID0+IGEud2VpZ2h0ID4gYi53ZWlnaHQ/IDEgOiAtMSlcclxuICAgIH1cclxuXHJcbiAgICBzZXRFeGFjdFdlaWdodHMoKXtcclxuICAgICAgICBmb3IgKGxldCBpIGluIHRoaXMudGFibGVJbmRleCl7XHJcbiAgICAgICAgICAgIGxldCBsYXllclRhYmxlcyA9IHRoaXMudGFibGVJbmRleFtpXTtcclxuICAgICAgICAgICAgbGF5ZXJUYWJsZXMgPSBsYXllclRhYmxlcy5zb3J0KChhLCBiKSA9PiBhLndlaWdodCA+IGIud2VpZ2h0PyAxIDogLTEpXHJcbiAgICAgICAgICAgIGZvciAobGV0IGogaW4gbGF5ZXJUYWJsZXMpe1xyXG4gICAgICAgICAgICAgICAgbGV0IHRhYmxlID0gbGF5ZXJUYWJsZXNbal1cclxuICAgICAgICAgICAgICAgIHRhYmxlLndlaWdodCA9IGpcclxuXHJcbiAgICAgICAgICAgICAgICBsZXQgYXR0cnMgPSB0YWJsZS5hdHRyaWJ1dGVzO1xyXG4gICAgICAgICAgICAgICAgYXR0cnMgPSBhdHRycy5zb3J0KChhLCBiKSA9PiBhLndlaWdodCA+IGIud2VpZ2h0PyAxIDogLTEpXHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIGZvciAobGV0IGsgaW4gYXR0cnMpe1xyXG4gICAgICAgICAgICAgICAgICAgIGF0dHJzW2tdLndlaWdodCA9IGtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufSIsImNsYXNzIEdyYXBoR2VuZXJhdG9yIHtcclxuICAgIGNvbnN0cnVjdG9yKGRlcHRoPTMsIHNlZWQ9XCJoZWxsb1wiLCB0YWJsZURpc3RyaWJ1dGlvbiA9IFsyLDNdLCBhdHRyaWJ1dGVEaXN0cmlidXRpb249WzEsIDVdKXtcclxuICAgICAgICB0aGlzLmQgPSBkZXB0aDtcclxuICAgICAgICB0aGlzLnMgPSAzO1xyXG4gICAgICAgIHRoaXMuamQgPSAwLjE7XHJcbiAgICAgICAgdGhpcy5qcyA9IDAuMDU7XHJcbiAgICAgICAgdGhpcy5hdHRyaWJ1dGVDb3VudGVyID0gMDtcclxuICAgICAgICB0aGlzLnNlZWQgPSBzZWVkO1xyXG5cclxuICAgICAgICAvLyByYW5kb20gbnVtYmVyIGdlbmVyYXRvcnNcclxuICAgICAgICB0aGlzLnJuZyA9IG5ldyBNYXRoLnNlZWRyYW5kb20odGhpcy5zZWVkKTtcclxuICAgICAgICB0aGlzLnRhYmxlRGlzdCA9ICgpID0+IHRhYmxlRGlzdHJpYnV0aW9uWzBdICsgTWF0aC5yb3VuZCh0aGlzLnJuZygpICogKHRhYmxlRGlzdHJpYnV0aW9uWzFdIC0gdGFibGVEaXN0cmlidXRpb25bMF0pKVxyXG4gICAgICAgIHRoaXMuYXR0ckRpc3QgPSAoKSA9PiBhdHRyaWJ1dGVEaXN0cmlidXRpb25bMF0gKyBNYXRoLnJvdW5kKHRoaXMucm5nKCkgKiAoYXR0cmlidXRlRGlzdHJpYnV0aW9uWzFdIC0gYXR0cmlidXRlRGlzdHJpYnV0aW9uWzBdKSlcclxuICAgIH1cclxuXHJcbiAgICBnZW5lcmF0ZSgpe1xyXG4gICAgICAgIGcgPSBuZXcgR3JhcGgoKVxyXG5cclxuICAgICAgICBmb3IgKHZhciBpPTE7IGk8dGhpcy5kOyBpKyspe1xyXG4gICAgICAgICAgICBnLm5ld0xheWVyKClcclxuICAgICAgICAgICAgZm9yICh2YXIgaj0wOyBqPHRoaXMudGFibGVEaXN0KCk7IGorKyl7XHJcbiAgICAgICAgICAgICAgICBnLmFkZFRhYmxlKHRoaXMuZ2VuZXJhdGVUYWJsZShpLCBqKSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5nZW5lcmF0ZVByb2plY3Rpb25zKGcpO1xyXG4gICAgICAgIHRoaXMuZ2VuZXJhdGVKb2lucyhnKTtcclxuICAgICAgICBcclxuICAgICAgICBnLmVuc3VyZVVuaXF1ZUVkZ2VzKCk7XHJcblxyXG4gICAgICAgIHJldHVybiBnO1xyXG4gICAgfVxyXG5cclxuICAgIGdlbmVyYXRlVGFibGUoZGVwdGgsIGluZGV4KXtcclxuICAgICAgICBuYW1lID0gXCJUXCIgKyBkZXB0aCArIFwiX1wiICsgaW5kZXhcclxuICAgICAgICB2YXIgbmV3VGFibGUgPSBuZXcgVGFibGUobmFtZSwgbmFtZSwgZmFsc2UsIGRlcHRoKTtcclxuXHJcbiAgICAgICAgZm9yICh2YXIgaT0wOyBpPHRoaXMuYXR0ckRpc3QoKTsgaSsrKXtcclxuICAgICAgICAgICAgbmV3VGFibGUuYWRkQXR0cmlidXRlKFwiYVwiICsgdGhpcy5hdHRyaWJ1dGVDb3VudGVyKTtcclxuICAgICAgICAgICAgdGhpcy5hdHRyaWJ1dGVDb3VudGVyICs9IDE7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gbmV3VGFibGVcclxuICAgIH1cclxuXHJcbiAgICBnZW5lcmF0ZVByb2plY3Rpb25zKGcpe1xyXG4gICAgICAgIGxldCBsYXllcjEgPSBnLnRhYmxlSW5kZXhbMV07XHJcbiAgICAgICAgbGV0IGxheWVyMWF0dHJzID0gW107XHJcbiAgICAgICAgbGV0IHNlbGVjdFRhYmxlID0gbmV3IFRhYmxlKFwic2VsZWN0XCIsIFwiU0VMRUNUXCIsIHRydWUsIDApXHJcbiAgICAgICAgbGV0IHByb2plY3RlZEF0dHJzID0gW107XHJcbiAgICAgICAgbGV0IHByb2plY3RlZCA9IFtdO1xyXG4gICAgICAgIGxldCBwcm9qZWN0ZWRDb3VudCA9IDA7XHJcblxyXG4gICAgICAgIGZvciAobGV0IHQgb2YgbGF5ZXIxKXtcclxuICAgICAgICAgICAgbGV0IGF0dHJzID0gdC5hdHRyaWJ1dGVzO1xyXG4gICAgICAgICAgICBsZXQgc3RyaWN0SW5kZXggPSBNYXRoLmZsb29yKHRoaXMucm5nKCkqYXR0cnMubGVuZ3RoKVxyXG4gICAgICAgICAgICBsZXQgc3RyaWN0ID0gYXR0cnNbc3RyaWN0SW5kZXhdXHJcbiAgICAgICAgICAgIHByb2plY3RlZEF0dHJzLnB1c2goc3RyaWN0KVxyXG4gICAgICAgICAgICBwcm9qZWN0ZWQucHVzaChzdHJpY3QpXHJcblxyXG4gICAgICAgICAgICBmb3IgKGxldCBhdHRyIG9mIGF0dHJzKXtcclxuICAgICAgICAgICAgICAgIGlmIChhdHRyICE9IHN0cmljdCl7XHJcbiAgICAgICAgICAgICAgICAgICAgbGF5ZXIxYXR0cnMucHVzaChuZXcgQXR0cmlidXRlKHQsIGF0dHIpKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHByb2plY3RlZENvdW50Kys7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgY291bnRQcm9qZWN0aW9ucyA9IHRoaXMucyAqIChsYXllcjFhdHRycy5sZW5ndGggKyBwcm9qZWN0ZWRDb3VudClcclxuXHJcbiAgICAgICAgZy5hZGRUYWJsZShzZWxlY3RUYWJsZSlcclxuXHJcbiAgICAgICAgZm9yICg7IHByb2plY3RlZENvdW50PGNvdW50UHJvamVjdGlvbnM7IHByb2plY3RlZENvdW50Kyspe1xyXG4gICAgICAgICAgICBsZXQgYXR0ckluZGV4ID0gTWF0aC5mbG9vcih0aGlzLnJuZygpKmxheWVyMWF0dHJzLmxlbmd0aClcclxuICAgICAgICAgICAgbGV0IGF0dHIgPSBsYXllcjFhdHRyc1thdHRySW5kZXhdXHJcbiAgICAgICAgICAgIGxheWVyMWF0dHJzLnNwbGljZShhdHRySW5kZXgsIDEpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmb3IgKGxldCBhdHRyIG9mIHByb2plY3RlZEF0dHJzKXtcclxuICAgICAgICAgICAgbGV0IG5ld0F0dHIgPSBuZXcgQXR0cmlidXRlKHNlbGVjdFRhYmxlLCBcImFcIiArIHRoaXMuYXR0cmlidXRlQ291bnRlcisrKVxyXG4gICAgICAgICAgICBzZWxlY3RUYWJsZS5hdHRyaWJ1dGVzLnB1c2gobmV3QXR0cilcclxuICAgICAgICAgICAgZy5hZGRFZGdlKG5ldyBFZGdlKHNlbGVjdFRhYmxlLCBuZXdBdHRyLCBhdHRyLnRhYmxlLCBhdHRyKSlcclxuICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICAvLyB3ZWlyZC4gbm90IGZpbmlzaGVkLlxyXG4gICAgfVxyXG5cclxuICAgIGdlbmVyYXRlSW50ZXJMYXllckpvaW5zKGcpe1xyXG4gICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgdGhpcy5kOyBpKyspe1xyXG4gICAgICAgICAgICBsZXQgbGVmdExheWVyID0gZy50YWJsZUluZGV4W2ldO1xyXG4gICAgICAgICAgICBsZXQgcmlnaHRMYXllciA9IGcudGFibGVJbmRleFtpICsgMV07XHJcblxyXG4gICAgICAgICAgICBsZXQgbGVmdExheWVyQXR0cnMgPSBbXTtcclxuICAgICAgICAgICAgbGV0IHJpZ2h0TGF5ZXJBdHRycyA9IFtdO1xyXG5cclxuICAgICAgICAgICAgZm9yIChsZXQgdGFibGUgb2YgbGVmdExheWVyKXtcclxuICAgICAgICAgICAgICAgIGxldCBhdHRycyA9IHRhYmxlLmF0dHJpYnV0ZXM7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBhdHRyIG9mIGF0dHJzKXtcclxuICAgICAgICAgICAgICAgICAgICBsZWZ0TGF5ZXJBdHRycy5wdXNoKG5ldyBBdHRyaWJ1dGUodGFibGUsIGF0dHIpKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBmb3IgKGxldCB0YWJsZSBvZiByaWdodExheWVyKXtcclxuICAgICAgICAgICAgICAgIGlmIChsZWZ0TGF5ZXJBdHRycy5sZW5ndGggPT0gMCkgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBsZXQgYXR0cnMgPSB0YWJsZS5hdHRyaWJ1dGVzO1xyXG5cclxuICAgICAgICAgICAgICAgIGxldCBzdHJpY3QgPSBhdHRyc1tNYXRoLmZsb29yKHRoaXMucm5nKCkqYXR0cnMubGVuZ3RoKV1cclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgbGV0IGxlZnRJbmRleCA9IE1hdGguZmxvb3IodGhpcy5ybmcoKSpsZWZ0TGF5ZXJBdHRycy5sZW5ndGgpXHJcbiAgICAgICAgICAgICAgICBsZXQgbGVmdCA9IGxlZnRMYXllckF0dHJzW2xlZnRJbmRleF1cclxuICAgICAgICAgICAgICAgIGxlZnRMYXllckF0dHJzLnNwbGljZShsZWZ0SW5kZXgsIDEpXHJcblxyXG4gICAgICAgICAgICAgICAgZy5hZGRFZGdlKG5ldyBFZGdlKGxlZnQudGFibGUsIGxlZnQuYXR0ciwgdGFibGUsIHN0cmljdCkpXHJcblxyXG4gICAgICAgICAgICAgICAgbGVmdC5kaWZmRWRnZXMrKztcclxuICAgICAgICAgICAgICAgIHN0cmljdC5kaWZmRWRnZXMrKztcclxuXHJcbiAgICAgICAgICAgICAgICBmb3IgKGxldCBhdHRyIG9mIGF0dHJzKXtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoYXR0ciAhPSBzdHJpY3QpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJpZ2h0TGF5ZXJBdHRycy5wdXNoKG5ldyBBdHRyaWJ1dGUodGFibGUsIGF0dHIpKVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBmb3IgKGxldCBsZWZ0IG9mIGxlZnRMYXllckF0dHJzKXtcclxuICAgICAgICAgICAgICAgIGlmIChyaWdodExheWVyQXR0cnMubGVuZ3RoID09IDApIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucm5nKCkgPCB0aGlzLmpkKXtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgcmlnaHRJbmRleCA9IE1hdGguZmxvb3IodGhpcy5ybmcoKSpyaWdodExheWVyQXR0cnMubGVuZ3RoKVxyXG4gICAgICAgICAgICAgICAgICAgIGxldCByaWdodCA9IHJpZ2h0TGF5ZXJBdHRyc1tyaWdodEluZGV4XVxyXG4gICAgICAgICAgICAgICAgICAgIHJpZ2h0TGF5ZXJBdHRycy5zcGxpY2UocmlnaHRJbmRleCwgMSlcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgZy5hZGRFZGdlKG5ldyBFZGdlKGxlZnQudGFibGUsIGxlZnQuYXR0ciwgcmlnaHQudGFibGUsIHJpZ2h0LmF0dHIpKVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBsZWZ0LmRpZmZFZGdlcysrO1xyXG4gICAgICAgICAgICAgICAgICAgIHJpZ2h0LmRpZmZFZGdlcysrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGdlbmVyYXRlSW5MYXllckpvaW5zKCl7XHJcbiAgICAgICAgZm9yICh2YXIgaT0xOyBpPHRoaXMuZDsgaSsrKXtcclxuICAgICAgICAgICAgbGV0IGxheWVyID0gZy50YWJsZUluZGV4W2ldO1xyXG5cclxuICAgICAgICAgICAgZm9yIChsZXQgdDEgb2YgbGF5ZXIpe1xyXG4gICAgICAgICAgICAgICAgbGV0IGF0dHJzMSA9IFtdO1xyXG4gICAgICAgICAgICAgICAgbGV0IGF0dHJzMiA9IFtdO1xyXG5cclxuICAgICAgICAgICAgICAgIGZvciAobGV0IGF0dHIgb2YgdDEuYXR0cmlidXRlcyl7XHJcbiAgICAgICAgICAgICAgICAgICAgYXR0cnMxLnB1c2gobmV3IEF0dHJpYnV0ZSh0MSwgYXR0cikpXHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgdDIgb2YgbGF5ZXIpe1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0MSA9PSB0MikgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgYXR0ciBvZiB0Mi5hdHRyaWJ1dGVzKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGF0dHIuc2FtZUVkZ2VzID09IDApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdHRyczIucHVzaChuZXcgQXR0cmlidXRlKHQyLCBhdHRyKSlcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgYXR0cjEgb2YgYXR0cnMxKXtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoYXR0cnMyLmxlbmd0aCA9PSAwKSBicmVhaztcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5ybmcoKSA8IHRoaXMuanMpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgYXR0cjJpbmRleCA9IE1hdGguZmxvb3IodGhpcy5ybmcoKSphdHRyczIubGVuZ3RoKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgYXR0cjIgPSBhdHRyczJbYXR0cjJpbmRleF1cclxuICAgICAgICAgICAgICAgICAgICAgICAgYXR0cnMyLnNwbGljZShhdHRyMmluZGV4LCAxKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICAgICAgZy5hZGRFZGdlKG5ldyBFZGdlKGF0dHIxLnRhYmxlLCBhdHRyMS5hdHRyLCBhdHRyMi50YWJsZSwgYXR0cjIuYXR0cikpXHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhdHRyMS5zYW1lRWRnZXMrKztcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXR0cjIuc2FtZUVkZ2VzKys7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGdlbmVyYXRlUmFuZG9tSm9pbnMoKXtcclxuICAgICAgICAvLyBmaW5pc2hcclxuICAgIH1cclxuXHJcbiAgICBnZW5lcmF0ZUpvaW5zKGcpe1xyXG4gICAgICAgIHRoaXMuZ2VuZXJhdGVJbnRlckxheWVySm9pbnMoZyk7XHJcbiAgICAgICAgdGhpcy5nZW5lcmF0ZUluTGF5ZXJKb2lucyhnKTtcclxuICAgICAgICB0aGlzLmdlbmVyYXRlUmFuZG9tSm9pbnMoZyk7XHJcbiAgICB9XHJcbn0iLCJjbGFzcyBUYWJsZSB7XHJcbiAgICBjb25zdHJ1Y3RvcihuYW1lLCBoZWFkZXIsIG1haW4sIGRlcHRoKXtcclxuICAgICAgICB0aGlzLm5hbWUgPSBuYW1lO1xyXG4gICAgICAgIHRoaXMuaGVhZGVyID0gaGVhZGVyO1xyXG4gICAgICAgIHRoaXMubWFpbiA9IG1haW47XHJcbiAgICAgICAgdGhpcy5kZXB0aCA9IGRlcHRoO1xyXG4gICAgICAgIHRoaXMuYXR0cmlidXRlcyA9IFtdO1xyXG4gICAgICAgIHRoaXMuYXR0ck1hcHMgPSBbXTtcclxuICAgICAgICB0aGlzLndlaWdodCA9IDA7XHJcbiAgICB9XHJcblxyXG4gICAgYWRkQXR0cmlidXRlKGF0dHJpYnV0ZSl7XHJcbiAgICAgICAgdGhpcy5hdHRyaWJ1dGVzLnB1c2gobmV3IEF0dHJpYnV0ZSh0aGlzLCBhdHRyaWJ1dGUpKVxyXG4gICAgfVxyXG5cclxuICAgIGNvbXBhcmVUbyhvdGhlclRhYmxlKXtcclxuICAgICAgICBpZiAodGhpcy5kZXB0aCA8IG90aGVyVGFibGUuZGVwdGgpIHJldHVybiAtMTtcclxuICAgICAgICBlbHNlIGlmICh0aGlzLmRlcHRoID4gb3RoZXJUYWJsZS5kZXB0aCkgcmV0dXJuIDE7XHJcbiAgICAgICAgZWxzZSByZXR1cm4gdGhpcy53ZWlnaHQgPiBvdGhlclRhYmxlLndlaWdodDtcclxuICAgIH1cclxufSJdfQ==
